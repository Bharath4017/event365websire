<div class="middle-section height-auto invite-user">
    <div style="margin-bottom: 3rem;" class="width-80">
        <div class="invite-top-section">
            <div class="invite-tabs">
                <button class="invite-tabs-btn" [ngClass]="{'active': selectedRsvpType === 1}"
                    (click)="selectRsvpType(1)">
                    {{ STRINGS.rsvpInvite.allContacts }}
                </button>
                <button class="invite-tabs-btn" [ngClass]="{'active': selectedRsvpType === 2}"
                    (click)="selectRsvpType(2)">
                    {{ STRINGS.rsvpInvite.pastAttendees }}
                </button>
            </div>

            <div class="invite-tabs-search">
                <div class="filter-wrapper filter-wrapper-mob">
                    <mat-form-field appearance="standard" floatLabel="always" class="matinput-space">
                        <input type="text" matInput placeholder="{{STRINGS.rsvpInvite.search}}" autocomplete="off"
                            class="invite-search" [(ngModel)]="payload.searchKey" (input)="searchRsvpList($event)" />
                        <img src="../../../assets/img/search@2x.png" class="search-icon" />
                    </mat-form-field>
                    <div class="filter" *ngIf="selectedRsvpType === 1">
                        <div>
                            <i class="fas fa-filter filter_icon" (click)="showFilterSearch()"></i>
                        </div>
                        <mat-form-field fxHide fxShow.gt-xs	 appearance="standard" floatLabel="always" class="testInput matinput-space matinput-space-filter" 
                        *ngIf="countrySearch">
                            
                            <input type="text" matInput placeholder="{{STRINGS.rsvpInvite.searchcountry}}" class="invite-search" (input)="searchLocationFilter($event)"
                            [matAutocomplete]="auto"/>
                            <img src="../../../assets/img/search@2x.png" class="search-icon" />
                            <mat-autocomplete #auto="matAutocomplete">
                                <mat-option *ngFor="let option of locationArray" [value]="option" (click)="selectLocation(option)">
                                  {{option}}
                                </mat-option>
                              </mat-autocomplete>
                        </mat-form-field>
                    </div>
                </div>

                <mat-form-field fxHide fxShow.xs appearance="standard" floatLabel="always" class="w-100 testInput matinput-space matinput-space-filter" 
                *ngIf="countrySearch">
                    
                    <input type="text" matInput placeholder="{{STRINGS.rsvpInvite.searchcountry}}" class="invite-search" (input)="searchLocationFilter($event)"
                    [matAutocomplete]="auto"/>
                    <img src="../../../assets/img/search@2x.png" class="search-icon" />
                    <mat-autocomplete #auto="matAutocomplete">
                        <mat-option *ngFor="let option of locationArray" [value]="option" (click)="selectLocation(option)">
                          {{option}}
                        </mat-option>
                      </mat-autocomplete>
                </mat-form-field>

                <div class="filter-wrapper">
                    <section class="example-section margin-right" *ngIf="selectedRsvpType === 1">
                        <mat-checkbox color="primary" style="transform: scale(1.5)" class="example-margin"
                            (change)="selectAllContacts($event)" [checked]="isSelectAllContacts"></mat-checkbox>
                        <span class="select">{{ STRINGS.rsvpInvite.select}}</span>
                    </section>
                    <div class="filter" *ngIf="selectedRsvpType === 2">
                        <div (click)="openFilter()">
                            <i class="fas fa-filter filter_icon"></i>
                            <span class="filter-text">{{ STRINGS.rsvpInvite.filter}}</span>
                        </div>


                        <div *ngIf="showFilterPastAttendees" class="select_popup_cat">
                            <p class="select_popup_p" *ngIf="eventList.length > 0" [ngClass]="{'active': isEventPopup}" (click)="showEventPopup()"><i
                                    class="fas fa-chevron-left select_icon"></i>Event Name</p>

                            <div (click)="showDatePicker()">
                                <p class="select_popup_p" [ngClass]="{'active': isShowDatepicker}"
                                    (click)="picker.open()"><i class="fas fa-chevron-left select_icon"></i>By Date</p>
                            </div>

                            <div class="date-picker-position">

                                <mat-date-range-input style="visibility: hidden;width: 0;height:0"  [rangePicker]="picker" [max]="maxDate">
                                    <input matStartDate type="text" placeholder="Start Date" [(ngModel)]="startDate"
                                        (dateChange)="chooseFilterDate()"
                                        style="visibility: hidden;width: 0;height:0" />
                                    <input matEndDate type="text" placeholder="End Date" [(ngModel)]="endDate"
                                        (dateChange)="chooseFilterDate()"
                                        style="visibility: hidden;width: 0;height:0" />
                                </mat-date-range-input>

                                <mat-date-range-picker id="invitedp" class="picker-position" #picker
                                    [calendarHeaderComponent]="customHeader">
                                    <mat-datepicker-actions>
                                        <button mat-button matDatepickerCancel class="btn-text-gray">Cancel</button>
                                        <button mat-raised-button matDatepickerApply class="btn-text-blue">Ok</button>
                                    </mat-datepicker-actions>
                                </mat-date-range-picker>
                            </div>
                            <p class="select_popup_p" style="margin-left: 2rem;" (click)="resetFilterValues()">Reset</p>
                        </div>

                        <div *ngIf="isEventPopup" class="select_popup_subcat">
                            <p class="select_popup_p" [ngClass]="{'active': selectedEventFilter === events.id}"
                                *ngFor="let events of eventList" (click)="selectEventFilter(events)">{{events.name}}</p>

                        </div>
                    </div>


                    <button class="primary-btn invite-btn"  (click)="sendInvite()">
                        {{ STRINGS.buttons.invite }}
                    </button>
                </div>
            </div>
        </div>

        <div class="user-card-wrapper" *ngIf="selectedRsvpType === 1">
            <div class="user-card" *ngFor="let user of rsvpList">
                <div class="card-profile">
                    <div class="card-user-image">
                        <ng-container *ngIf="!user?.profilePic; else elseBlock">
                            <ngx-avatar name="{{user.name}}" class="avatar-container avatar-custom" [round]="false"
                                cornerRadius="14"></ngx-avatar>
                        </ng-container>
                        <ng-template #elseBlock>
                            <img [src]="user?.profilePic" class="card-profile">
                        </ng-template>

                    </div>
                    <div class="user-info">
                        <p class="user-name">{{user.name | titlecase}}</p>
                        <p class="user-email"> {{ user?.email}} </p>
                    </div>
                   
                </div>
                <section class="example-section">

                    <mat-checkbox color="primary" style="transform: scale(1.5)" class="example-margin"
                        [checked]="selectedAllContactRsvpUsers.includes(user.id)"
                        (change)="selectAllContactsRsvpUser($event, user)"></mat-checkbox>
                </section>

            </div>
            <div fxlayout="row" *ngIf="rsvpList?.length == 0 || datanothere" class="w-100">
                <p class="datanotFound">{{STRINGS.dataNotFound.dataNfound}} </p>
              </div>
        </div>

        <div class="user-card-wrapper" *ngIf="selectedRsvpType === 2">
            <div class="user-card-wrapper" *ngFor="let event of rsvpList">
                <div class="select_date">
                    <p class="user-name">{{event.name | titlecase}} ({{event.start | date: 'd MMMM, y'}})</p>
                    <section class="example-section">
                        <mat-checkbox class="example-margin" color="primary" style="transform: scale(1.5)" (change)="selectAllPastAttendees($event, event)" [checked]="Object.keys(selectedPastAttendeesRsvpUsers).includes(event.id.toString()) && selectedPastAttendeesRsvpUsers[event.id]?.allChecked" [indeterminate]="selectedPastAttendeesRsvpUsers[event.id]?.partialChecked">
                        </mat-checkbox>
                        <span class="select">{{ STRINGS.rsvpInvite.select}}</span>
                    </section>
                </div>
                <div class="user-card" *ngFor="let user of event.ticketBooked">
                    <div class="card-profile">
                        <div class="card-user-image">
                            <ng-container *ngIf="!user?.users.profilePic; else elseBlock">
                                <ngx-avatar name="{{user.users.name}}" size="75" [round]="false" cornerRadius="14">
                                </ngx-avatar>
                            </ng-container>
                            <ng-template #elseBlock>
                                <img [src]="user?.users?.profilePic" class="card-profile h-100">
                            </ng-template>

                        </div>
                        <p class="user-name">{{user.users.name | titlecase}}</p>
                    </div>
                    <section class="example-section">
                        <mat-checkbox color="primary" style="transform: scale(1.5)" class="example-margin" (change)="selectPastAttendeesRsvpUsers($event, user, event)" [checked]="selectedPastAttendeesRsvpUsers[event.id]?.userSelected.includes(user.userId)"></mat-checkbox>
                    </section>
                </div>
            </div>

            <div fxlayout="row" *ngIf="rsvpList?.length == 0 || datanothere" class="w-100">
                <p class="datanotFound">{{STRINGS.dataNotFound.dataNfound}} </p>
              </div>

        </div>
        <mat-paginator [length]="totalCount" [pageSize]="10" [pageSizeOptions]="[10]" [pageIndex]="pageIndex"
            (page)="handlePageEvent($event)">
        </mat-paginator>
    </div>
</div>